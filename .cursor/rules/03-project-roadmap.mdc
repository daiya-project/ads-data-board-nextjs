---
description: Migration roadmap — env, layout/sidebar, report UI, shared lib/utils, data connection
alwaysApply: true
---

# Project Migration Roadmap

This roadmap guides the order of work for migrating the vanilla TypeScript app to Next.js. It is aligned with **`02-project-migration.mdc`**: use `docs/MIGRATION_ANALYSIS.md` and the `reference/` source when implementing each phase.

## Phase 0 — Basic project environment

- Set up and verify the **foundation** so the rest of the migration can proceed.
- Use **project skills** (e.g. Next.js App Router, Vercel/React best practices, frontend design) where they apply.
- Ensure:
  - Next.js (App Router), React, Tailwind, Shadcn/ui, and Supabase client are correctly configured.
  - Environment variables, Supabase URLs/keys, and local run (e.g. `npm run dev`) work.
  - TypeScript, ESLint, and project structure match `00-project-main.mdc` and `01-project-structure-rule.mdc`.

**Done when:** App runs locally, builds cleanly, and is ready for layout and pages.

---

## Phase 1 — Sidebar and layout

- Create **sidebar** and **layout** files so all pages share a consistent shell.
- Reference: `docs/MIGRATION_ANALYSIS.md` (routing, navigation) and `reference/` (e.g. `reference/ts-ads/src/shared/ui/common/Sidebar/`, navigation feature).
- Deliver:
  - Root or dashboard layout that includes the sidebar.
  - Sidebar component (nav items, active state, links to main sections: Dashboard, Reports, Goal Weekly, Goal Monthly, Settings).
  - Route groups and placeholders for main pages so navigation works without full content.

**Done when:** Navigating via sidebar shows the correct route and a basic layout; no feature content required yet.

---

## Phase 2 — Report section appearance

- Implement the **report section UI** (look and structure only — no live data yet).
- Reference: `docs/MIGRATION_ANALYSIS.md` (Reports feature) and `reference/ts-ads/src/features/reports/`.
- Deliver:
  - Report page(s) under the App Router (e.g. daily/weekly or a single report view with tabs/filters).
  - Outer structure: filters (date range, etc.), table/chart placeholders, and any controls that exist in the reference.
  - Use Tailwind and Shadcn/ui; components can use mock or empty data for now.

**Done when:** Report section looks and behaves like the reference in terms of layout and controls; data is static or mock.

---

## Phase 3 — Shared libraries and utils

- Create **shared libraries and utilities** used across features.
- Reference: `docs/MIGRATION_ANALYSIS.md` (shared modules, data flow) and `reference/ts-ads/src/shared/` (lib, api, utils, types).
- Deliver:
  - **lib/utils/** (or equivalent) with barrel export; date/format/validation helpers as needed.
  - **lib/api/** stubs or modules for report/dashboard data access (signatures aligned with reference).
  - **types/** (or app-db.types) for shared types; align with reference and Supabase schema.
  - Any shared logic in **lib/** or **lib/logic/** that is reused by report and other features.

**Done when:** Common helpers and API/data layer shape are in place and importable; no need for full implementation of every endpoint yet.

---

## Phase 4 — Data connection

- **Connect the app to real data** (Supabase and any other backends).
- Reference: `docs/MIGRATION_ANALYSIS.md` (data flow, API, cache) and `reference/` (shared/api, features’ load/fetch logic).
- Deliver:
  - **lib/api/** (and Supabase client usage) implemented for report and, as needed, dashboard/settings.
  - Server Components or server-side data fetching where appropriate; Client Components + Zustand only where needed.
  - Report section (and any other sections in scope) reading from Supabase and reflecting real data.
  - Respect project rules: `client_id` as string, date/workday rules per `31-term-main.mdc`, etc.

**Done when:** Report (and any other prioritized sections) load and display real data; behavior matches reference semantics.

---

## Workflow

- **Before starting a task:** Check this roadmap and `02-project-migration.mdc`; confirm which phase you are in.
- **After completing a phase (or a step within it):** Mark progress (e.g. in planning or in this file’s checklist) and proceed to the next step.
- **When in doubt:** Prefer completing an earlier phase before moving to a later one (0 → 1 → 2 → 3 → 4).

## Checklist (phases)

- [ ] Phase 0 — Basic project environment
- [ ] Phase 1 — Sidebar and layout
- [ ] Phase 2 — Report section appearance
- [ ] Phase 3 — Shared libraries and utils
- [ ] Phase 4 — Data connection
